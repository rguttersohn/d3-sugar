class Core{constructor(t){this.selector=t,this.height=0,this.width=0,this.margin=50,this.legend=[],this.domain=[],this.padding="",this.wrapperWidth=0}get root(){return d3.select(this.selector)}get setParentDimension(){return this.root.style("width",this.width+this.margin+"px").style("margin-top","50px")}get commaFormatter(){return d3.format(",")}get percentFormatter(){return d3.format(",.1%")}get localMin(){return d3.min(this.data,(t=>t[`${this.stat}`]))}get localMax(){return d3.max(this.data,(t=>t[`${this.stat}`]))}get hideLineY(){return d3.selectAll(`${this.selector} svg .y-axis .domain`).style("visibility","hidden")}get hideLineX(){return d3.select(`${this.selector} svg .x-axis .domain`).style("visibility","hidden")}get flatten(){return this.data.forEach((t=>{Object.values(t).map((t=>{"string"!=typeof t&&this.domain.push(t)}))}))}get max(){return Math.max(...this.domain)}get min(){return Math.min(...this.domain)}get lineFunc(){return d3.line().x((t=>this.scaleBandHorizontal(t[`${this.indicator}`])+this.scaleBandHorizontal.bandwidth()/2)).y((t=>this.scaleLinearVertical(t[this.stat]))).curve(d3.curveLinear)}get scaleBandHorizontal(){return d3.scaleBand().range([0,this.width]).domain(this.data.map((t=>t[`${this.indicator}`]))).padding(this.padding)}get scaleBandVertical(){return d3.scaleBand().range([0,this.height]).domain(this.data.map((t=>t[`${this.indicator}`]))).padding(this.padding)}get scaleLinearHorizontal(){return d3.scaleLinear().range([0,this.width]).domain(this.min>=0?[0,this.max+5]:[this.min-5,this.max+5])}get scaleLinearVertical(){return d3.scaleLinear().range([this.height,0]).domain(this.min>=0?[0,this.max+5]:[this.min-5,this.max+5])}addHeader(t){return this.root.insert("h3","svg"),d3.select(`${this.selector} h3`).style("text-align","center").style("width",this.wrapperWidth+2*this.margin+"px").text((()=>{if(t)return t})),this}addLegend({legendLabel:t}={}){return this.root.append("div").attr("class","legend").style("margin","auto").style("display","flex").style("width",this.wrapperWidth+2*this.margin+"px").style("justify-content","space-evenly").style("align-items","flex-start").selectAll("div").data(this.legend).enter().append("div").style("display","flex").style("align-items","baseline").html("<i></i><span></span>"),d3.selectAll(`${this.selector} .legend i`).attr("class","legend-icon").style("display","inline-block").style("margin-right","5px").style("width","15px").style("height","15px").data(this.data).style("background-color",((t,i)=>this.legend[i].color)),d3.selectAll(`${this.selector} .legend span`).attr("class","legend-label").data(this.data).text(((i,a)=>t?Array.isArray(t)?t[a]:i[t]:this.legend[a].indicator)),this}}class CCCVerticalBarChart extends Core{constructor(t,i,a){super(i,a),this.data=t,this.indicator="",this.stat=""}createChart({width:t=300,height:i=400,indicator:a,stat:s}={}){a?this.indicator=a:a=this.indicator,s?this.stat=s:s=this.stat;for(let t=0;t<this.data.length;t++)this.legend.push({}),this.legend[t].indicator=this.data[t][`${this.indicator}`];if(this.width=t,this.wrapperWidth=t,this.height=i,t&&i)return this.flatten,this.setParentDimension,this.root.append("svg").attr("width",this.width+2*this.margin).attr("height",this.height+this.margin),this}addBars({padding:t=.2,opacity:i=1}={}){return this.padding=t,d3.select(`${this.selector} svg`).append("g").attr("class","bars").selectAll("rect").data(this.data).enter().append("rect").attr("height",(()=>0)).attr("y",(()=>this.scaleLinearVertical(0))).attr("x",(t=>this.scaleBandHorizontal(t[`${this.indicator}`]))).attr("width",this.scaleBandHorizontal.bandwidth()).attr("transform",`translate(${this.margin},${this.margin/2})`).style("opacity",i).transition().duration(300).attr("y",(t=>this.min>=0?this.scaleLinearVertical(t[`${this.stat}`]):t[`${this.stat}`]<0?this.scaleLinearVertical(0):this.scaleLinearVertical(t[`${this.stat}`]))).attr("height",(t=>this.min>=0?this.height-this.scaleLinearVertical(t[`${this.stat}`]):this.scaleLinearVertical(0)-this.scaleLinearVertical(Math.abs(t[`${this.stat}`])))),this.min<0&&d3.select(`${this.selector} svg`).append("g").attr("class","dividing-line").append("line").attr("x1",this.margin).attr("x2",this.margin+this.width).attr("y1",this.scaleLinearVertical(0)+this.margin/2).attr("y2",this.scaleLinearVertical(0)+this.margin/2).style("stroke","lightgray").style("stroke-width","1px"),this}addXAxis({tickSizeOuter:t=0,tickSizeInner:i=null,tickPadding:a=3,hideLine:s=!1,axisLabels:e}={}){if(0!==this.width||0!==this.height)return d3.select(this.selector+"  svg").append("g").attr("class","x-axis").attr("transform",`translate(${this.margin},${this.height+this.margin/2})`).call(d3.axisBottom(this.scaleBandHorizontal).tickSizeOuter(t).tickSizeInner(i).tickPadding(a)),s&&this.hideLineX,Array.isArray(e)&&d3.selectAll(`${this.selector} svg .x-axis .tick text`).html(((t,i)=>e[i])),this}addYAxis({formatPunctuation:t="commaSeparate",ticks:i=10,tickSizeOuter:a=0,tickSizeInner:s=null,tickValues:e=null,tickPadding:r=3,hideLine:n=!1,axisLabel:h}={}){if(0!==this.width||0!==this.height)return d3.select(this.selector+" svg").append("g").attr("class","y-axis").attr("transform",`translate(${this.margin},${this.margin/2})`).call(d3.axisLeft(this.scaleLinearVertical).tickFormat((i=>"addPercent"===t?i+"%":"commaSeparate"===t||!1===t?this.commaFormatter(i):void 0)).ticks(i).tickSizeOuter(a).tickSizeInner(s).tickValues(e).tickPadding(r)),d3.selectAll(`${this.selector} svg .y-axis .tick line`).style("stroke","gainsboro"),n&&this.hideLineY,Array.isArray(h)&&d3.selectAll(`${this.selector} svg .y-axis .tick text`).html(((t,i)=>h[i])),this}addLabels({formatPunctuation:t="commaSeparate",dx:i=0,dy:a=0,color:s="black",fontWeight:e="normal",fontSize:r=null,show:n=!1}={}){if(0!==this.width||0!==this.height){if(d3.select(this.selector+" svg").append("g").attr("class","labels").selectAll("text").data(this.data).enter().append("text").text((t=>{if(Array.isArray(n)){let i=Array.from(this.data.map((t=>t[`${this.stat}`])));if(n.includes("first")&&t[`${this.stat}`]===i[0])return t[`${this.stat}`];if(n.includes("last")&&t[`${this.stat}`]===i[i.length-1])return t[`${this.stat}`];if(n.includes("max")&&t[`${this.stat}`]===this.localMax)return t[`${this.stat}`];if(n.includes("min")&&t[`${this.stat}`]===this.localMin)return t[`${this.stat}`]}else if(!n)return t[`${this.stat}`]})).attr("y",(t=>this.scaleLinearVertical(t[`${this.stat}`])+20)).attr("dy",a).attr("x",(t=>this.scaleBandHorizontal(t[`${this.indicator}`])+this.scaleBandHorizontal.bandwidth()/2)).attr("dx",i).attr("text-anchor","middle").attr("transform",`translate(${this.margin},0)`).attr("fill",s).style("font-family","sans-serif").style("font-weight",e).style("font-size",r),t){let i=document.querySelectorAll(`${this.selector} svg .labels text`);for(let a of i)a.textContent&&("addPercent"===t?a.textContent=a.textContent+"%":"commaSeparate"!==t&&!1!==t||(a.textContent=this.commaFormatter(a.textContent)))}return this}}addColors(t){for(let i=0;i<t.length;i++)this.legend[i].color=t[i];return d3.selectAll(`${this.selector} svg .bars rect`).data(this.data).attr("fill",((i,a)=>{if(Array.isArray(t))return 1===t.length?t[0]:this.legend[a].color})),this}}class CCCHorizontalBarChart extends Core{constructor(t,i){super(i),this.data=t,this.indicator="",this.stat=""}createChart({width:t=400,height:i=300,indicator:a="indicator",stat:s="stat"}={}){this.indicator=a,this.stat=s;for(let t=0;t<this.data.length;t++)this.legend.push({}),this.legend[t].indicator=this.data[t][`${this.indicator}`];if(this.width=t,this.wrapperWidth=t,this.height=i,t&&i)return this.flatten,this.setParentDimension,this.root.append("svg").attr("width",this.width+2*this.margin).attr("height",this.height+this.margin).append("g").attr("class","bars"),this}addBars({padding:t=.2,opacity:i=1}={}){return this.padding=t,d3.select(`${this.selector} svg`).append("g").attr("class","bars").append("g").selectAll("rect").data(this.data).enter().append("rect").attr("x",(()=>this.scaleLinearHorizontal(0))).attr("y",(t=>this.scaleBandVertical(t[`${this.indicator}`]))).attr("transform",`translate(0,${this.margin/2})`).style("opacity",i).attr("height",(t=>this.scaleBandVertical.bandwidth())).transition().duration(300).attr("x",(t=>this.min>=0?this.margin:t[`${this.stat}`]>=0?this.scaleLinearHorizontal(0)+this.margin:this.margin+this.scaleLinearHorizontal(t[`${this.stat}`]))).attr("width",(t=>this.min>=0?this.scaleLinearHorizontal(t[`${this.stat}`]):Math.abs(this.scaleLinearHorizontal(t[`${this.stat}`])-this.scaleLinearHorizontal(0)))),this.min<0&&d3.select(`${this.selector} svg`).append("g").attr("class","dividing-line").append("line").attr("y1",0).attr("y2",this.height+this.margin/2).attr("x1",this.scaleLinearHorizontal(0)+this.margin).attr("x2",this.scaleLinearHorizontal(0)+this.margin).style("stroke","lightgray").style("stroke-width","1px"),this}addYAxis({tickSizeOuter:t=0,tickSizeInner:i=3,tickPadding:a=3,hideLine:s=!1,axisLabels:e}={}){if(0!==this.width||0!==this.height)return d3.select(this.selector+" svg").append("g").attr("class","y-axis").attr("transform",`translate(${this.margin},${this.margin/2})`).call(d3.axisLeft(this.scaleBandVertical).tickSizeOuter(t).tickSizeInner(i).tickPadding(a)),s&&this.hideLineY,Array.isArray(e)&&d3.selectAll(`${this.selector} svg .y-axis .tick text`).html(((t,i)=>e[i])),this}addXAxis({formatPunctuation:t="commaSeparate",ticks:i=10,tickSizeOuter:a=0,tickSizeInner:s=3,tickValues:e=null,tickPadding:r=10,hideLine:n=!1,axisLabels:h}={}){if(0!==this.width||0!==this.height)return d3.select(this.selector+"  svg").append("g").attr("class","x-axis").attr("transform",`translate(${this.margin},${this.height+this.margin/2})`).call(d3.axisBottom(this.scaleLinearHorizontal).tickFormat((i=>"addPercent"===t?i+"%":"commaSeparate"===t||!1===t?this.commaFormatter(i):void 0)).ticks(i).tickSizeOuter(a).tickSizeInner(s).tickValues(e).tickPadding(r)),d3.selectAll(`${this.selector} svg .x-axis .tick line`).style("stroke","gainsboro"),n&&this.hideLineX,Array.isArray(h)&&d3.selectAll(`${this.selector} svg .x-axis .tick text`).html(((t,i)=>h[i])),this}addLabels({formatPunctuation:t="commaSeparate",dx:i=0,dy:a=0,color:s="black",fontWeight:e="normal",fontSize:r=null,show:n=!1}={}){if(0!==this.width||0!==this.height){if(d3.select(this.selector+" svg").append("g").attr("class","labels").selectAll("text").data(this.data).enter().append("text").text((t=>{if(Array.isArray(n)){let i=Array.from(this.data.map((t=>t[`${this.stat}`])));if(n.includes("first")&&t[`${this.stat}`]===i[0])return t[`${this.stat}`];if(n.includes("last")&&t[`${this.stat}`]===i[i.length-1])return t[`${this.stat}`];if(n.includes("max")&&t[`${this.stat}`]===this.localMax)return t[`${this.stat}`];if(n.includes("min")&&t[`${this.stat}`]===this.localMin)return t[`${this.stat}`]}else if(!n)return t[`${this.stat}`]})).attr("x",(t=>this.scaleLinearHorizontal(t[`${this.stat}`])+20)).attr("dx",i).attr("y",(t=>this.scaleBandVertical(t[`${this.indicator}`])+this.scaleBandVertical.bandwidth()/2)).attr("dy",a).attr("text-anchor","middle").attr("transform",`translate(${this.margin},${this.margin/2})`).attr("fill",s).style("font-family","sans-serif").style("font-weight",e).style("font-size",r),t){let i=document.querySelectorAll(`${this.selector} svg .labels text`);for(let a of i)a.textContent&&("addPercent"===t?a.textContent=a.textContent+"%":"commaSeparate"!==t&&!1!==t||(a.textContent=this.commaFormatter(a.textContent)))}return this}}addColors(t){for(let i=0;i<t.length;i++)this.legend[i].color=t[i];return d3.selectAll(`${this.selector} svg .bars rect`).data(this.data).attr("fill",((i,a)=>{if(Array.isArray(t))return 1===t.length?t[0]:this.legend[a].color})),this}}class CCCPieChart extends Core{constructor(t,i,a){super(i,a),this.data=t,this.indicator="",this.stat=""}get pie(){return d3.pie().value((t=>t[`${this.stat}`]))(this.data)}get arc(){return d3.arc().innerRadius(10).outerRadius(this.width/2).padAngle(.05).padRadius(50)}createChart({width:t=300,height:i=300,indicator:a,stat:s}={}){a?this.indicator=a:a=this.indicator,s?this.stat=s:s=this.stat;for(let t=0;t<this.data.length;t++)this.legend.push({}),this.legend[t].indicator=this.data[t][`${a}`];if(this.height=i,this.width=t,this.wrapperWidth=t,t&&i)return this.flatten,this.setParentDimension,this.root.append("svg").attr("width",this.width+2*this.margin).attr("height",this.height+2*this.margin).append("g").attr("class","pie-chart").attr("transform",`translate(${this.width/2+this.margin},${this.height/2+this.margin})`).selectAll("path").data(this.pie).enter().append("path").attr("stroke","gray").attr("stroke-width","lightgray").attr("d",this.arc),this}addLabels({formatPunctuation:t="commaSeparate",dx:i=0,dy:a=0,color:s="black",fontWeight:e="normal",fontSize:r=null,show:n=!1}={}){let h=this;if(d3.select(`${this.selector} svg`).append("g").attr("class","pie-chart-labels").attr("transform",`translate(${this.width/2+this.margin},${this.height/2+this.margin})`).selectAll("text").data(this.pie).enter().append("text").each((function(t){const i=h.arc.centroid(t);d3.select(this).attr("x",i[0]).attr("y",i[1])})).attr("dx",i).attr("dy",a).attr("text-anchor","middle").text((t=>{if(Array.isArray(n)){let i=Array.from(this.data.map((t=>t[`${this.stat}`])));if(n.includes("first")&&t.value===i[0])return t.value;if(n.includes("last")&&t.value===i[i.length-1])return t.value;if(n.includes("max")&&t.value===this.localMax)return t.value;if(n.includes("min")&&t.value===this.localMin)return t.value}else if(!n)return t.value})).attr("fill",s).style("font-family","sans-serif").style("font-weight",e).style("font-size",r),t){let i=document.querySelectorAll(`${this.selector} svg .pie-chart-labels text`);for(let a of i)a.textContent&&("addPercent"===t?a.textContent=a.textContent+"%":"commaSeparate"!==t&&!1!==t||(a.textContent=this.commaFormatter(a.textContent)))}return this}addColors(t){for(let i=0;i<t.length;i++)this.legend[i].color=t[i];return d3.selectAll(`${this.selector} svg .pie-chart path`).data(this.data).attr("fill",((i,a)=>{if(Array.isArray(t))return 1===t.length?t[0]:this.legend[a].color})),this}}class CCCLineChart extends Core{constructor(t,i,a){super(i,a),this.data=t,this.stat="",this.indicator="",this.lineIteration=0,this.dotIteration=0,this.labelIteration=0}createChart({width:t=400,height:i=300,indicator:a,stat:s}={}){if(a?this.indicator=a:a=this.indicator,s?this.stat=s:s=this.stat,this.stat=s,this.width=t,this.wrapperWidth=t,this.height=i,t&&i)return this.flatten,this.setParentDimension,this.root.append("svg").attr("width",this.width+this.margin).attr("height",this.height+this.margin+this.margin).append("g"),this}addXAxis({tickSizeOuter:t=0,tickSizeInner:i=null,tickPadding:a=3,hideLine:s=!1,axisLabels:e}={}){return d3.select(`${this.selector} svg`).append("g").attr("class","x-axis").attr("transform",`translate(${this.margin},${this.height+this.margin})`).call(d3.axisBottom(this.scaleBandHorizontal).tickSizeOuter(t).tickSizeInner(i).tickPadding(a)),s&&this.hideLineX,Array.isArray(e)&&d3.selectAll(`${this.selector} svg .x-axis .tick text`).html(((t,i)=>e[i])),this}addYAxis({formatPunctuation:t="commaSeparate",ticks:i=10,tickSizeOuter:a=0,tickSizeInner:s=3,tickValues:e=null,tickPadding:r=10,hideLine:n=!1,axisLabels:h}={}){return d3.select(`${this.selector} svg`).append("g").attr("class","y-axis").attr("transform",`translate(${this.margin},${this.margin})`).call(d3.axisLeft(this.scaleLinearVertical).tickFormat((i=>"addPercent"===t?i+"%":"commaSeparate"===t||!1===t?this.commaFormatter(i):void 0)).ticks(i).tickSizeOuter(a).tickSizeInner(s).tickValues(e).tickPadding(r)),d3.selectAll(`${this.selector} svg .y-axis .tick line`).style("stroke","gainsboro"),n&&this.hideLineY,Array.isArray(h)&&d3.selectAll(`${this.selector} svg .y-axis .tick text`).html(((t,i)=>h[i])),this}addLine(t="black"){this.lineIteration++;let i={};i.color=t,i.indicator=this.indicator,this.legend.push(i),d3.select(`${this.selector} svg`).append("g").attr("class",`line-${this.lineIteration}`).append("path").attr("d",this.lineFunc(this.data)).attr("transform",`translate(${this.margin},${this.margin})`).attr("stroke",t).attr("stroke-width",2).attr("fill","none");let a=d3.select(`${this.selector} svg .line-${this.lineIteration} path`),s=a._groups[0][0].getTotalLength();return a.attr("stroke-dasharray",s).attr("stroke-dashoffset",s).transition().duration(500).attr("stroke-dashoffset",0),this}addLabels({stat:t,formatPunctuation:i="commaSeparate",dx:a=0,dy:s=0,color:e="black",fontWeight:r="normal",fontSize:n=null,show:h=!1}={}){if(this.labelIteration++,t?this.stat=t:t=this.stat,0!==this.width||0!==this.height){if(d3.select(this.selector+" svg").append("g").attr("class",`labels-${this.labelIteration}`).selectAll("text").data(this.data).enter().append("text").text((t=>{if(Array.isArray(h)){let i=Array.from(this.data.map((t=>t[`${this.stat}`])));if(h.includes("first")&&t[`${this.stat}`]===i[0])return t[`${this.stat}`];if(h.includes("last")&&t[`${this.stat}`]===i[i.length-1])return t[`${this.stat}`];if(h.includes("max")&&t[`${this.stat}`]===this.localMax)return t[`${this.stat}`];if(h.includes("min")&&t[`${this.stat}`]===this.localMin)return t[`${this.stat}`]}else if(!h)return t[`${this.stat}`]})).attr("y",(t=>this.scaleLinearVertical(t[this.stat])+20)).attr("dy",s).attr("x",(t=>this.scaleBandHorizontal(t[`${this.indicator}`])+this.scaleBandHorizontal.bandwidth()/2)).attr("dx",a).attr("text-anchor","middle").attr("fill",e).attr("transform",`translate(${this.margin},${this.margin/2})`).style("font-family","sans-serif").style("font-weight",r).style("font-size",n),i){let t=document.querySelectorAll(`${this.selector} svg .labels-${this.labelIteration} text`);for(let a of t)a.textContent&&("addPercent"===i?a.textContent=a.textContent+"%":"commaSeparate"!==i&&!1!==i||(a.textContent=this.commaFormatter(a.textContent)))}return this}}addDots(t="black",{stat:i,r:a=5}={}){if(this.dotIteration++,i?this.stat=i:i=this.stat,0!==this.width||0!==this.height)return d3.select(`${this.selector} svg`).append("g").attr("class",`dots-${this.dotIteration}`).selectAll("circle").data(this.data).enter().append("circle").attr("cx",(t=>this.scaleBandHorizontal(t[`${this.indicator}`])+this.scaleBandHorizontal.bandwidth()/2)).attr("cy",(t=>this.scaleLinearVertical(t[this.stat]))).attr("r",a).attr("transform",`translate(${this.margin},${this.margin})`).attr("fill",t),this}}class CCCCombinationChart extends Core{constructor(t,i){super(i),this.data=t,this.indicator="",this.stat="",this.lineIteration=0,this.dotIteration=0,this.labelIteration=0}get flatten(){return this.domain.pop(),this.data.forEach((t=>{this.domain.push(t[`${this.stat}`])}))}createChart({width:t=300,height:i=300,indicator:a="indicator",stat:s="stat"}={}){if(this.indicator=a,this.stat=s,this.width=t,this.wrapperWidth=t,this.height=i,t&&i)return this.flatten,this.setParentDimension,this.root.append("svg").attr("width",this.width+2*this.margin).attr("height",this.height+this.margin),this}addBars(t,{data:i,width:a,indicator:s,stat:e,padding:r=.2,opacity:n=1,translateX:h=0,translateY:l=0,spreadX:d=1}={}){if(this.padding=r,i?this.data=i:i=this.data,a?this.width=a:a=this.width,e?this.stat=e:e=this.stat,s?this.indicator=s:s=this.indicator,t){let i={};i.color=t,i.indicator=e,this.legend.push(i)}return d3.select(`${this.selector} svg`).append("g").attr("class","bars").attr("width",this.width).selectAll("rect").data(this.data).enter().append("rect").attr("x",(t=>this.scaleBandHorizontal(t[`${this.indicator}`])*d)).attr("width",this.scaleBandHorizontal.bandwidth()).attr("transform",`translate(${this.margin+h},${this.margin/2+l})`).style("opacity",n).attr("fill",((i,a)=>{if("string"==typeof t)return t})).attr("height",(()=>0)).attr("y",(()=>this.scaleLinearVertical(0))).transition().duration(300).attr("y",(t=>this.min>=0?this.scaleLinearVertical(t[`${this.stat}`]):t[`${this.stat}`]<0?this.scaleLinearVertical(0):this.scaleLinearVertical(t[`${this.stat}`]))).attr("height",(t=>this.min>=0?this.height-this.scaleLinearVertical(t[`${this.stat}`]):this.scaleLinearVertical(0)-this.scaleLinearVertical(Math.abs(t[`${this.stat}`])))),d3.select(`${this.selector} svg g`),this.min<0&&d3.select(`${this.selector} svg`).append("g").attr("class","dividing-line").append("line").attr("x1",this.margin).attr("x2",this.margin+this.wrapperWidth).attr("y1",this.scaleLinearVertical(0)+this.margin/2).attr("y2",this.scaleLinearVertical(0)+this.margin/2).style("stroke","lightgray").style("stroke-width","1px"),this}addLine(t="black",{data:i,width:a,indicator:s,stat:e,translateX:r=0,translateY:n=0}={}){this.lineIteration++,i?this.data=i:i=this.data,a?this.width=a:a=this.width,e?this.stat=e:e=this.stat,s?this.indicator=s:s=this.indicator;let h={};h.color=t,h.indicator=e,this.legend.push(h),d3.select(`${this.selector} svg`).append("g").attr("class",`line-${this.lineIteration}`).attr("width",this.width).append("path").attr("d",this.lineFunc(this.data)).attr("transform",`translate(${this.margin},${this.margin})`).attr("stroke",((i,a)=>{if("string"==typeof t)return t})).attr("stroke-width",2).attr("fill","none").attr("transform",`translate(${this.margin+r},${this.margin/2+n})`);let l=d3.select(`${this.selector} svg .line-${this.lineIteration} path`),d=l._groups[0][0].getTotalLength();return l.attr("stroke-dasharray",d).attr("stroke-dashoffset",d).transition().duration(500).attr("stroke-dashoffset",0),this}addPlotPoints(t,{data:i,width:a,indicator:s,stat:e,padding:r=.2,opacity:n=1,translateX:h=0,translateY:l=0,spreadX:d=1,r:c=20,stroke:o=null,strokeWidth:g=0}={}){if(this.padding=r,i?this.data=i:i=this.data,a?this.width=a:a=this.width,e?this.stat=e:e=this.stat,s?this.indicator=s:s=this.indicator,t){let i={};i.color=t,i.indicator=e,this.legend.push(i)}return d3.select(`${this.selector} svg`).append("g").attr("class","plot-point-lines").selectAll("line").data(this.data).enter().append("line").attr("x1",(t=>this.scaleBandHorizontal(t[`${this.indicator}`])*d+this.scaleBandHorizontal.bandwidth()/2)).attr("x2",(t=>this.scaleBandHorizontal(t[`${this.indicator}`])*d+this.scaleBandHorizontal.bandwidth()/2)).attr("stroke-width","1px").attr("stroke","gray").attr("stroke-dasharray",3).attr("transform",`translate(${this.margin+h},${this.margin/2+l})`).attr("y1",this.scaleLinearVertical(0)).attr("y2",this.scaleLinearVertical(0)).transition().duration(300).attr("y1",(t=>this.scaleLinearVertical(t[`${this.stat}`]))).attr("y2",(()=>this.min>=0?this.height:this.scaleLinearVertical(0))),d3.select(`${this.selector} svg`).append("g").attr("class","plot-points").attr("width",this.width).selectAll("circle").data(this.data).enter().append("circle").attr("cx",(t=>this.scaleBandHorizontal(t[`${this.indicator}`])*d+this.scaleBandHorizontal.bandwidth()/2)).attr("cy",this.scaleLinearVertical(0)).attr("r",c).attr("transform",`translate(${this.margin+h},${this.margin/2+l})`).style("opacity",n).attr("fill",((i,a)=>{if("string"==typeof t)return t})).attr("stroke",o).attr("strokeWidth",g).transition().duration(300).attr("cy",(t=>this.min>=0?this.scaleLinearVertical(t[`${this.stat}`]):t[`${this.stat}`]<0?this.height-this.scaleLinearVertical(Math.abs(t[`${this.stat}`])):this.scaleLinearVertical(t[`${this.stat}`]))),this.min<0&&d3.select(`${this.selector} svg`).append("g").attr("class","dividing-line").append("line").attr("x1",this.margin).attr("x2",this.margin+this.wrapperWidth).attr("y1",this.scaleLinearVertical(0)+this.margin/2).attr("y2",this.scaleLinearVertical(0)+this.margin/2).style("stroke","lightgray").style("stroke-width","1px"),this}addDots(t="black",{data:i,stat:a,indicator:s,r:e=5,width:r,translateX:n=0,translateY:h=0}={}){if(this.dotIteration++,0!==this.width||0!==this.height)return i?this.data=i:i=this.data,r?this.width=r:r=this.width,a?this.stat=a:a=this.stat,s?this.indicator=s:s=this.indicator,d3.select(`${this.selector} svg`).append("g").attr("class",`dots-${this.dotIteration}`).attr("width",this.width).selectAll("circle").data(this.data).enter().append("circle").attr("cx",(t=>this.scaleBandHorizontal(t[`${this.indicator}`])+this.scaleBandHorizontal.bandwidth()/2)).attr("cy",(t=>this.scaleLinearVertical(t[this.stat]))).attr("r",e).attr("transform",`translate(${this.margin+n},${this.margin/2+h})`).attr("fill",t),this}addXAxis({tickSizeOuter:t=0,tickSizeInner:i=null,tickPadding:a=3,hideLine:s=!1,axisLabels:e}={}){if(0!==this.width||0!==this.height)return d3.select(this.selector+"  svg").append("g").attr("class","x-axis").attr("transform",`translate(${this.margin},${this.height+this.margin/2})`).call(d3.axisBottom(this.scaleBandHorizontal).tickSizeOuter(t).tickSizeInner(i).tickPadding(a)),s&&this.hideLineX,Array.isArray(e)&&d3.selectAll(`${this.selector} svg .x-axis .tick text`).html(((t,i)=>e[i])),this}addYAxis({data:t,formatPunctuation:i="commaSeparate",ticks:a=10,tickSizeOuter:s=0,tickSizeInner:e=null,tickValues:r=null,tickPadding:n=3,hideLine:h=!1,axisLabel:l,orient:d="left"}={}){if(0!==this.width||0!==this.height)return t?this.data=t:t=this.data,this.domain=[],this.flatten,"left"===d?d3.select(this.selector+" svg").append("g").attr("class","y-axis").attr("transform",`translate(${this.margin},${this.margin/2})`).call(d3.axisLeft(this.scaleLinearVertical).tickFormat((t=>"addPercent"===i?t+"%":"commaSeparate"===i||!1===i?this.commaFormatter(t):void 0)).ticks(a).tickSizeOuter(s).tickSizeInner(e).tickValues(r).tickPadding(n)):"right"===d&&d3.select(this.selector+" svg").append("g").attr("class","y-axis").attr("transform",`translate(${this.margin+this.wrapperWidth},${this.margin/2})`).call(d3.axisRight(this.scaleLinearVertical).tickFormat((t=>"addPercent"===i?t+"%":"commaSeparate"===i||!1===i?this.commaFormatter(t):void 0)).ticks(a).tickSizeOuter(s).tickSizeInner(e).tickValues(r).tickPadding(n)),d3.selectAll(`${this.selector} svg .y-axis .tick line`).style("stroke","gainsboro"),h&&this.hideLineY,Array.isArray(l)&&d3.selectAll(`${this.selector} svg .y-axis .tick text`).html(((t,i)=>l[i])),this}addLabels({stat:t,indicator:i,formatPunctuation:a="commaSeparate",dx:s=0,dy:e=0,color:r="black",fontWeight:n="normal",fontSize:h=null,show:l=!1}={}){if(0!==this.width||0!==this.height){if(t?this.stat=t:t=this.stat,i?this.indicator=i:i=this.indicator,this.labelIteration++,d3.select(this.selector+" svg").append("g").attr("class",`labels-${this.labelIteration}`).selectAll("text").data(this.data).enter().append("text").text((t=>{if(Array.isArray(l)){let i=Array.from(this.data.map((t=>t[`${this.stat}`])));if(l.includes("first")&&t[`${this.stat}`]===i[0])return t[`${this.stat}`];if(l.includes("last")&&t[`${this.stat}`]===i[i.length-1])return t[`${this.stat}`];if(l.includes("max")&&t[`${this.stat}`]===this.localMax)return t[`${this.stat}`];if(l.includes("min")&&t[`${this.stat}`]===this.localMin)return t[`${this.stat}`]}else if(!l)return t[`${this.stat}`]})).attr("y",(t=>this.scaleLinearVertical(t[`${this.stat}`])+20)).attr("dy",e).attr("x",(t=>this.scaleBandHorizontal(t[`${this.indicator}`])+this.scaleBandHorizontal.bandwidth()/2)).attr("dx",s).attr("text-anchor","middle").attr("transform",`translate(${this.margin},0)`).attr("fill",r).style("font-family","sans-serif").style("font-weight",n).style("font-size",h),a){let t=document.querySelectorAll(`${this.selector} svg .labels-${this.labelIteration} text`);for(let i of t)i.textContent&&("addPercent"===a?i.textContent=i.textContent+"%":"commaSeparate"!==a&&!1!==a||(i.textContent=this.commaFormatter(i.textContent)))}return this}}}export{CCCVerticalBarChart,CCCHorizontalBarChart,CCCPieChart,CCCLineChart,CCCCombinationChart};